<!DOCTYPE html>
<html>
    <head>
        <title>Settings</title>
    </head>
    <body onload="pageLoad()">
        <div data-role="page">
            <div data-role="header">
                <a data-role="button" data-rel="back" href="#page1" data-icon="arrow-l"
                    data-iconpos="left" class="ui-btn-left">
                    Back
                </a>
                
               
            </div>
            <div data-role="content">
                <div class="didits_scale_unit">
                    <div class="didits_scale_unit_title didits-btn">
                        Scale Unit:
                    </div>
                    <select name="didits_scale_unit" id="didits_scale_unit_toggle" data-role="slider">
                        <option id='metric' value="metric">Metric System</option>
                        <option id='imperial' value="imperial">Imperial System</option>
                    </select>
                </div>
                <script>
                    
                    document.addEventListener("deviceready", onDeviceReady, false);
                    
                    function onDeviceReady() {
                        
                        window.plugins.applicationPreferences.get('scaleUnit', function (result) {
                            var val = result;
                            if(val=='metric'){
                                var myswitch = $('#didits_scale_unit_toggle');
                                // myswitch[0].selectedIndex =0;
                                // myswitch.selectmenu('refresh');
                                alert('metric:'+result);
                                // $('#metric').attr('selected',true).siblings('option').removeAttr('selected');
                                
                                // $('#metric').slider("refresh", true);

                            }else{
                                alert('imp: '+result);
                                var myswitch = $('#didits_scale_unit_toggle');
                                // myswitch[0].selectedIndex =1;
                                // myswitch.selectmenu('refresh');
                                $('#imperial').attr('selected',true).siblings('option').removeAttr('selected');
                                // $('#metric').slider();
                                // $('#imperial').slider("refresh", true);
                            }
                                                                  
                        },function(error){
                            console.log("error getting scaleunit: "+error);                                 
                        });
                        

                        $('#didits_scale_unit_toggle').on('change',function(){
                            that = $(this).val();
                            if(that=='metric'){
                                window.plugins.applicationPreferences.set('scaleUnit','metric', function (result) {
                                }, function (error) {
                                    console.log("Failed to set scaleUnit: " + error);
                                });

                            }  else{
                                window.plugins.applicationPreferences.set('scaleUnit','imperial', function (result) {
                                }, function (error) {
                                    console.log("Failed to set scaleUnit: " + error);
                                });

                            }
                        });

                        
                        
                       //  $('#didits_scale_unit_toggle').change(function(){
                       //       if(val!==$(this).val()){
                       //          window.plugins.applicationPreferences.set('scaleUnit','imperial', function () {
                       //          },function(error){
                       //              console.lot(error); 
                       //          });
                       //       }
                       //      else {
                       //      window.plugins.applicationPreferences.set('scaleUnit','metric', function () {
                            
                       //      function(error) {
                       //             console.log(error);
                       //      });
                                                              
                       //      }
                       //      val = $(this).val();
                       // });
                        
                    }
                    
                    </script>
            </div>
        </div>
    </body>
</html>
